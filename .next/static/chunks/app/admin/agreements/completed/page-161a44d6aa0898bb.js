(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1376],{5871:(e,t,r)=>{Promise.resolve().then(r.bind(r,6570))},6570:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var o=r(5155),n=r(2115),i=r(8758),s=r(6046),a=r(8129);function l(){let[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),{isDark:u}=(0,i.D)(),p=(0,s.useRouter)(),{showToast:x,ToastContainer:g}=(0,a.d)();(0,n.useEffect)(()=>{let e=()=>{c(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.useEffect)(()=>{f()},[]);let f=async()=>{try{l(!0);let e=await fetch("/api/agreements/completed");if(e.ok){let r=await e.json();t(r)}else x("Failed to fetch completed agreements","error")}catch(e){console.error("Error fetching completed agreements:",e),x("Error fetching completed agreements","error")}finally{l(!1)}},m=async e=>{if(confirm("Are you sure you want to archive this completed agreement? It will be moved to the archived section."))try{l(!0);let t=await fetch("/api/agreements/archive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agreementId:e})});if(t.ok)x("Agreement archived successfully","success"),f();else{let e=await t.json();x(e.error||"Failed to archive agreement","error")}}catch(e){console.error("Error archiving agreement:",e),x("Error archiving agreement","error")}finally{l(!1)}},h=u?"#1e293b":"#ffffff",b=u?"#f1f5f9":"#1e293b",y=u?"#94a3b8":"#64748b",v=u?"#334155":"#e2e8f0";return(0,o.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:u?"#0f172a":"#f8fafc",padding:d?"16px":"24px"},children:[(0,o.jsx)(g,{}),(0,o.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",flexDirection:d?"column":"row",gap:d?"16px":"0"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{style:{margin:"0 0 8px 0",fontSize:d?"24px":"32px",fontWeight:"700",color:b},children:"Completed Agreements"}),(0,o.jsx)("p",{style:{margin:"0",color:y,fontSize:"16px"},children:"View and manage completed agreements"})]}),(0,o.jsx)("button",{onClick:()=>p.push("/admin/agreements"),style:{backgroundColor:"#6b7280",color:"white",border:"none",padding:d?"12px 20px":"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",width:d?"100%":"auto"},title:"Back to main agreements",children:"← Back to Agreements"})]}),r?(0,o.jsxs)("div",{style:{backgroundColor:h,border:"1px solid ".concat(v),borderRadius:"8px",padding:"48px 24px",textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"24px",marginBottom:"16px"},children:"⏳"}),(0,o.jsx)("p",{style:{margin:"0",color:b},children:"Loading completed agreements..."})]}):0===e.length?(0,o.jsx)("div",{style:{backgroundColor:h,border:"1px solid ".concat(v),borderRadius:"8px",padding:"48px 24px",textAlign:"center"},children:(0,o.jsx)("p",{style:{margin:"0",color:y,fontSize:"16px"},children:"No completed agreements found."})}):(0,o.jsx)("div",{style:{display:"grid",gap:"16px"},children:e.map(e=>(0,o.jsxs)("div",{style:{backgroundColor:h,border:"1px solid ".concat(v),borderRadius:"8px",padding:"20px"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"12px",flexDirection:d?"column":"row",gap:d?"12px":"0"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{margin:"0 0 4px 0",fontSize:"16px",color:b,fontWeight:"600"},children:e.template.title}),(0,o.jsxs)("p",{style:{margin:"0 0 4px 0",color:y,fontSize:"14px"},children:[e.client.firstName," ",e.client.lastName," (",e.client.email,")"]}),(0,o.jsxs)("p",{style:{margin:"0 0 4px 0",color:y,fontSize:"14px"},children:["Completed: ",e.signedAt?new Date(e.signedAt).toLocaleDateString("en-CA",{timeZone:"America/Toronto"}):"N/A"]})]}),(0,o.jsx)("div",{style:{display:"flex",gap:"8px",flexDirection:d?"column":"row"},children:(0,o.jsx)("span",{style:{fontSize:"12px",color:"white",backgroundColor:"#7c3aed",padding:"4px 8px",borderRadius:"4px",alignSelf:d?"flex-start":"auto"},children:"Completed"})})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,o.jsx)("button",{onClick:()=>window.open("/agreement/".concat(e.uniqueToken),"_blank"),style:{backgroundColor:"#3b82f6",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#2563eb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#3b82f6"},title:"View agreement",children:"View"}),(0,o.jsx)("button",{onClick:()=>m(e.id),disabled:r,style:{backgroundColor:r?"#9ca3af":"#6b7280",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:r?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},onMouseEnter:e=>{r||(e.currentTarget.style.backgroundColor="#4b5563")},onMouseLeave:e=>{r||(e.currentTarget.style.backgroundColor="#6b7280")},title:"Archive this completed agreement",children:r?"Archiving...":"Archive"})]})]},e.id))})]})]})}},8129:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});var o=r(5155),n=r(2115);function i(e){let{message:t,type:r="success",duration:i=3e3,onClose:s}=e,[a,l]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=setTimeout(()=>{l(!1),setTimeout(()=>null==s?void 0:s(),300)},i);return()=>clearTimeout(e)},[i,s]),(0,o.jsx)("div",{style:(()=>{let e={position:"fixed",top:"20px",right:"20px",zIndex:9999,padding:"12px 20px",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transform:a?"translateX(0)":"translateX(100%)",transition:"transform 0.3s ease-in-out",maxWidth:"300px",wordWrap:"break-word"};switch(r){case"success":default:return{...e,backgroundColor:"#10b981"};case"error":return{...e,backgroundColor:"#ef4444"};case"info":return{...e,backgroundColor:"#3b82f6"}}})(),children:t})}function s(){let[e,t]=(0,n.useState)([]),r=e=>{t(t=>t.filter(t=>t.id!==e))};return{showToast:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",o=Date.now();t(t=>[...t,{id:o,message:e,type:r}])},ToastContainer:()=>(0,o.jsx)("div",{children:e.map(e=>(0,o.jsx)(i,{message:e.message,type:e.type,onClose:()=>r(e.id)},e.id))})}}},8758:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,L:()=>s});var o=r(5155),n=r(2115);let i=(0,n.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("darkMode");null!==e&&s(JSON.parse(e))},[]),(0,n.useEffect)(()=>{localStorage.setItem("darkMode",JSON.stringify(r))},[r]),(0,o.jsx)(i.Provider,{value:{isDark:r,toggleDarkMode:()=>{s(!r)}},children:t})}function a(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useDarkMode must be used within a DarkModeProvider");return e}},6046:(e,t,r)=>{"use strict";var o=r(6658);r.o(o,"useParams")&&r.d(t,{useParams:function(){return o.useParams}}),r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1517,7358],()=>t(5871)),_N_E=e.O()}]);